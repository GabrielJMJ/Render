function Element(e){this.id=e,this.vars=[]}function Render(){this.elements=[]}Element.prototype.setVar=function(e,t){if(this.vars.length){var n=!1;for(var r in this.vars)this.vars[r].name===e&&(this.vars[r].value=t,n=!0);n||this.vars.push({name:e,value:t})}else this.vars.push({name:e,value:t})},Element.prototype.getId=function(){return this.id},Element.prototype.getVars=function(){return this.vars},Element.prototype.getVar=function(e){for(var t in this.vars)if(this.vars[t].name===e)return this.vars[t].value},Render.prototype.element=function(e){return this.elements.push(new Element(e)),this.currentElement=e,this},Render.prototype.setVar=function(e,t){for(var n in this.elements)this.elements[n].getId()===this.currentElement&&(this.elements[n].setVar(e,t),this.elements[n]=this.elements[n]);return this},Render.prototype.getVars=function(e){return this.getVarsFromContent(document.getElementById(e).innerHTML)},Render.prototype.getLists=function(e){for(var t=/\$foreach\(([a-zA-Z0-9. ]+)\)\{\s.*\s+\}/g,n=/\$foreach\(.*\)\{(\s+.*\s+)\}/g,r=/(\$foreach\(.*\)\{\s.*\s+\})/g,s=document.getElementById(e).innerHTML,a=[];null!==(names=r.exec(s));){var i=names[1],o=t.exec(i);o=o[1];var l=o.split(" as ");o=l[0],l=l[l.length-1];var v=n.exec(i);v=v[1];var m={array:o,"var":l,content:v,complete:i};a.push(m)}return a},Render.prototype.getVar=function(e,t){for(var n in this.elements)if(this.elements[n].getId()===e)return this.elements[n].getVar(t)},Render.prototype.getVarsFromContent=function(e){for(var t=/\${([a-zA-Z0-9._\.]+)}/g,n=[];null!=(vars=t.exec(e));)n.push(vars[1]);return n},Render.prototype.render=function(){for(var k in this.elements){var element=this.elements[k],vars=this.getVars(element.getId()),elementV=element.getVars(),lists=this.getLists(element.getId()),el=document.getElementById(element.getId()),content=el.innerHTML,elVars=element.getVars(),contentList=[];for(var l in lists){var contentVars=this.getVarsFromContent(lists[l].content);for(var y in elementV)if(lists[l].array===elementV[y].name)for(var v in contentVars){var objVarSplit=contentVars[v].split(".");if(objVar=objVarSplit[0],objVar===lists[l]["var"]){var listArr=this.getVar(element.getId(),lists[l].array);originalObj=objVarSplit.join(".");for(var lv in listArr){var newObjVar=objVarSplit;newObjVar[0]="listArr[lv]";var obj=newObjVar.join(".");contentList.push(lists[l].content.replace("${"+originalObj+"}",eval(obj)))}}}content=content.replace(lists[l].complete,contentList.join(""))}for(var z in elVars)for(var y in vars)vars[y]===elVars[z].name&&(content=content.replace("${"+vars[y]+"}",elVars[z].value));el.innerHTML=content}},render=new Render;